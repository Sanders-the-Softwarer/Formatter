SELECT t9.moniker,t9.id_ware_ishopattr,
GREATEST(NVL(t9.ishop_change,TO_DATE('01.01.1950','DD.MM.YYYY')),NVL(t9.ware_change,TO_DATE('01.01.1950','DD.MM.YYYY')),NVL(t10.discount_change,TO_DATE('01.01.1950','DD.MM.YYYY')))
AS WARE_CHANGE, t9.attr_group, t9.attr_name,t9.value FROM (
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Краткое описание Бел.' as ATTR_NAME, TO_CHAR(t1.short_desc_bel) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'short_desc_bel'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Краткое описание Укр.' as ATTR_NAME, TO_CHAR(t1.short_desc_ukr) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'short_desc_ukr'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Краткое описание Каз.' as ATTR_NAME, TO_CHAR(t1.short_desc_kaz) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'short_desc_kaz'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Полное описание Рос.' as ATTR_NAME, TO_CHAR(t1.full_desc_rus) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'full_desc_rus'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Полное описание Бел.' as ATTR_NAME, TO_CHAR(t1.full_desc_bel) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'full_desc_bel'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Полное описание Укр.' as ATTR_NAME, TO_CHAR(t1.full_desc_ukr) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'full_desc_ukr'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Полное описание Каз.' as ATTR_NAME, TO_CHAR(t1.full_desc_kaz) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'full_desc_kaz'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Длинна нетто' as ATTR_NAME, TO_CHAR(t1.net_length) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'net_length'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Вес нетто, кг' as ATTR_NAME, TO_CHAR(t1.net_weight) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'net_weight'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Вес брутто, кг' as ATTR_NAME, TO_CHAR(t1.gross_weight) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'gross_weight'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Ширина нетто' as ATTR_NAME, TO_CHAR(t1.net_width) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'net_width'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Высота нетто' as ATTR_NAME, TO_CHAR(t1.net_height) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'net_height'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Длинна брутто' as ATTR_NAME, TO_CHAR(t1.gross_length) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'gross_length'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Ширина брутто' as ATTR_NAME, TO_CHAR(t1.gross_width) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'gross_width'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Высота брутто' as ATTR_NAME, TO_CHAR(t1.gross_height) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'gross_height'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Состав' as ATTR_NAME, TO_CHAR(t1.id_composition) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'id_composition'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Используемые технологии' as ATTR_NAME, TO_CHAR(t1.id_tech_in_use) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'id_tech_in_use'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Краткое описание Рос.' as ATTR_NAME, TO_CHAR(t1.short_desc_rus) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'short_desc_rus'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Код Товара' as ATTR_NAME, pu_get_attr.get_attr_value('obj_20',
pu_get_attr.get_attr_value('ware_ishopattr',t1.id_ware_ishopattr,'id_ware','N'
),'$IMAGE','N') AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'id_ware'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Есть фото?' as ATTR_NAME, pu_get_attr.get_attr_value('ware_ishopattr',t1.id_ware_ishopattr,'have_photo','N'
) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'have_photo'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
t4.name,t5.value
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t3, t_ishop_attr t4, t_ware_ishopattr_str t5, tm_attr t6
WHERE
t1.id_ware = t2.id_ware
AND t3.name IN( (SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
),'Нецелевые')
AND (t3.id_ishop_attr_group = t4.id_ishop_attr_group)
AND t1.id_ware_ishopattr = t5.id_ware_ishopattr(+) AND NVL(t5.attr_code,t4.attr_code) = t4.attr_code
AND t6.code = t4.attr_code AND t6.key_type || '' = 'ware_ishopattr' AND t6.KEY_FIELD || '' LIKE '%:str%'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Кличка' as ATTR_NAME, TO_CHAR(t2.moniker) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'obj_2'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Вид 2' as ATTR_NAME, TO_CHAR(t2.e_kind) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'obj_1010'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Артикул производителя' as ATTR_NAME, pu_get_attr.get_attr_value('obj_20',t1.id_ware, 'obj_1051','N') AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'obj_1051'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Цвет' as ATTR_NAME, pu_get_attr.get_attr_value('obj_20',t1.id_ware, 'obj_1111','N') AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'obj_1111'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Размер 2 оригинальный' as ATTR_NAME, pu_get_attr.get_attr_value('obj_20',t1.id_ware, 'obj_1042','N') AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'obj_1042'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Размер отечественный' as ATTR_NAME, pu_get_attr.get_attr_value('obj_20',t1.id_ware, 'obj_1040','N') AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'obj_1040'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Срок гарантии' as ATTR_NAME, pu_get_attr.get_attr_value('obj_20',t1.id_ware, 'obj_1113','N') AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'obj_1113'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Название (Белорусское)' as ATTR_NAME, pu_get_attr.get_attr_value('obj_20',t1.id_ware, 'obj_1013','N') AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'obj_1013'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Название (Русское)' as ATTR_NAME, pu_get_attr.get_attr_value('obj_20',t1.id_ware, 'obj_1012','N') AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'obj_1012'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Название (Украинское)' as ATTR_NAME, pu_get_attr.get_attr_value('obj_20',t1.id_ware, 'obj_1014','N') AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'obj_1014'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Название оригинальное' as ATTR_NAME, pu_get_attr.get_attr_value('obj_20',t1.id_ware, 'obj_1020','N') AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'obj_1020'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Назначение' as ATTR_NAME, pu_get_attr.get_attr_value('obj_20',t1.id_ware, 'obj_1204','N') AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'obj_1204'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Состав одежды' as ATTR_NAME, pu_get_attr.get_attr_value('obj_20',t1.id_ware, 'obj_1205','N') AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'obj_1205'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Вид спорта' as ATTR_NAME, pu_get_attr.get_attr_value('obj_20',t1.id_ware, 'obj_1089','N') AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'obj_1089'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Вес нетто (кг)' as ATTR_NAME, pu_get_attr.get_attr_value('obj_20',t1.id_ware, 'obj_1072','N') AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'obj_1072'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Название (Казахское)' as ATTR_NAME, pu_get_attr.get_attr_value('obj_20',t1.id_ware, 'obj_1016','N') AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'obj_1016'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Категория' as ATTR_NAME, pu_get_attr.chain('obj_20',t1.id_ware, 'category.$IMAGE','N') AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'category'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Пол' as ATTR_NAME, pu_get_attr.chain('obj_20',t1.id_ware, 'gender.$IMAGE','N') AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'gender'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Возраст 1' as ATTR_NAME, pu_get_attr.chain('obj_20',t1.id_ware, 'age1.$IMAGE','N') AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'age1'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Страна изготовитель(стар.)' as ATTR_NAME, pu_get_attr.chain('obj_20',t1.id_ware, 'obj_1202.$IMAGE','N') AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'obj_1202'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Направление' as ATTR_NAME, pu_get_attr.chain('obj_20',t1.id_ware, 'direction.$IMAGE','N') AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'direction'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Товарная группа' as ATTR_NAME, pu_get_attr.chain('obj_20',t1.id_ware, 'ware_group.$IMAGE','N') AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'ware_group'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Товарная подгруппа' as ATTR_NAME, pu_get_attr.chain('obj_20',t1.id_ware, 'subgroup.$IMAGE','N') AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'subgroup'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Торговая марка' as ATTR_NAME, pu_get_attr.chain('obj_20',t1.id_ware, 'trademark.$IMAGE','N') AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ishop_attr_group t11, t_ishop_attr t12
WHERE t1.id_ware = t2.id_ware AND t11.name IN (
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
)
,'Нецелевые') AND t11.id_ishop_attr_group = t12.id_ishop_attr_group AND t12.attr_code = 'trademark'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Цена в российских рублях' as ATTR_NAME, TO_CHAR(pk_wl_ishop.get_catalog_price4dept(t2.id_ware,pk_wl_ishop.get_shopnet('g_shopnet_ishop'),SYSDATE)) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2
WHERE t1.id_ware = t2.id_ware
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Скидка в российских рублях' as ATTR_NAME, TO_CHAR(pk_wl_ishop.get_retail_discount(pk_wl_ishop.get_shopnet('g_shopnet_ishop'),t2.id_ware,SYSDATE)) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2
WHERE t1.id_ware = t2.id_ware
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Цена со скидкой в российских рублях' as ATTR_NAME, TO_CHAR(pk_wl_ishop.get_retail_price4dept(t2.id_ware,pk_wl_ishop.get_shopnet('g_shopnet_ishop'),SYSDATE)) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2
WHERE t1.id_ware = t2.id_ware
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Цена в белорусских рублях' as ATTR_NAME, TO_CHAR(pk_wl_ishop.get_catalog_price4dept(t2.id_ware,pk_wl_ishop.get_shopnet('g_shopnet_bel'),SYSDATE)) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2
WHERE t1.id_ware = t2.id_ware
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Скидка в белорусских рублях' as ATTR_NAME, TO_CHAR(pk_wl_ishop.get_retail_discount(pk_wl_ishop.get_shopnet('g_shopnet_bel'),t2.id_ware,SYSDATE)) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2
WHERE t1.id_ware = t2.id_ware
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Цена со скидкой в белорусских рублях' as ATTR_NAME, TO_CHAR(pk_wl_ishop.get_retail_price4dept(t2.id_ware,pk_wl_ishop.get_shopnet('g_shopnet_bel'),SYSDATE)) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2
WHERE t1.id_ware = t2.id_ware
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Цена в гривнах' as ATTR_NAME, TO_CHAR(pk_wl_ishop.get_catalog_price4dept(t2.id_ware,pk_wl_ishop.get_shopnet('g_shopnet_ukr'),SYSDATE)) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2
WHERE t1.id_ware = t2.id_ware
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Скидка в гривнах' as ATTR_NAME, TO_CHAR(pk_wl_ishop.get_retail_discount(pk_wl_ishop.get_shopnet('g_shopnet_ukr'),t2.id_ware,SYSDATE)) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2
WHERE t1.id_ware = t2.id_ware
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Цена со скидкой в гривнах' as ATTR_NAME, TO_CHAR(pk_wl_ishop.get_retail_price4dept(t2.id_ware,pk_wl_ishop.get_shopnet('g_shopnet_ukr'),SYSDATE)) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2
WHERE t1.id_ware = t2.id_ware
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Цена в тенге' as ATTR_NAME, TO_CHAR(pk_wl_ishop.get_catalog_price4dept(t2.id_ware,pk_wl_ishop.get_shopnet('g_shopnet_kaz'),SYSDATE)) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2
WHERE t1.id_ware = t2.id_ware
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Скидка в тенге' as ATTR_NAME, TO_CHAR(pk_wl_ishop.get_retail_discount(pk_wl_ishop.get_shopnet('g_shopnet_kaz'),t2.id_ware,SYSDATE)) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2
WHERE t1.id_ware = t2.id_ware
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Цена со скидкой в тенге' as ATTR_NAME, TO_CHAR(pk_wl_ishop.get_retail_price4dept(t2.id_ware,pk_wl_ishop.get_shopnet('g_shopnet_kaz'),SYSDATE)) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2
WHERE t1.id_ware = t2.id_ware
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Главная фотография' as ATTR_NAME, COALESCE(
(SELECT t3.id_document || '.' || COALESCE(SUBSTR(t3.file_name,DECODE(INSTR(t3.file_name,'.',-1),0,NULL,INSTR(t3.file_name,'.',-1))+1),SUBSTR(t3.file_type,3),'jpg') FROM t_ware_document t3 WHERE t3.key_parent = t2.id_ware AND t3.parent_type = 'obj_20' AND t3.is_main='Y' AND t3.doc_type = 'PHOTO'),
(SELECT t3.id_document || '.' || COALESCE(SUBSTR(t3.file_name,DECODE(INSTR(t3.file_name,'.',-1),0,NULL,INSTR(t3.file_name,'.',-1))+1),SUBSTR(t3.file_type,3),'jpg') FROM t_ware_document t3 WHERE t3.key_parent = t2.id_mcolor_model AND t3.parent_type = 'ware_color_model' AND t3.is_main='Y' AND t3.doc_type = 'PHOTO'),
(SELECT t3.id_document || '.' || COALESCE(SUBSTR(t3.file_name,DECODE(INSTR(t3.file_name,'.',-1),0,NULL,INSTR(t3.file_name,'.',-1))+1),SUBSTR(t3.file_type,3),'jpg') FROM t_ware_document t3, t_wl_ware_ent t4 WHERE t2.id_ware = t4.id_ware AND t4.attr_code = 'obj_1056' AND t3.key_parent = t4.value AND t3.parent_type = 'obj_28' AND t3.is_main='Y' AND t3.doc_type = 'PHOTO')
) AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2
WHERE t1.id_ware = t2.id_ware
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Дополнительная фотография' as ATTR_NAME, t3.id_document || '.' || COALESCE(SUBSTR(t3.file_name,DECODE(INSTR(t3.file_name,'.',-1),0,NULL,INSTR(t3.file_name,'.',-1))+1),SUBSTR(t3.file_type,3),'jpg') AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ware_document t3
WHERE t1.id_ware = t2.id_ware AND t3.key_parent = t2.id_ware AND t3.parent_type = 'obj_20' AND t3.is_main IS NULL AND t3.doc_type = 'PHOTO'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Дополнительная фотография' as ATTR_NAME, t3.id_document || '.' || COALESCE(SUBSTR(t3.file_name,DECODE(INSTR(t3.file_name,'.',-1),0,NULL,INSTR(t3.file_name,'.',-1))+1),SUBSTR(t3.file_type,3),'jpg') AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ware_document t3
WHERE t1.id_ware = t2.id_ware AND t3.key_parent = t2.id_mcolor_model AND t3.parent_type = 'ware_color_model' AND t3.is_main IS NULL AND t3.doc_type = 'PHOTO'
UNION ALL
SELECT /*+ USE_NL(t1 t12) INDEX(t2 XPK_T_WL_WARE)*/ t2.moniker, t2.id_ware,t1.id_ware_ishopattr,NVL(t1.dtm_change,t1.dtm_create) AS ishop_change,NVL(t2.dtm_change,t2.dtm_create) AS ware_change,
(SELECT t6.name
FROM t_ishop_attr_group t6
WHERE ROWNUM < 2
AND (t6.ID_WARE_GROUP IS NOT NULL OR t6.ID_WARE_SUBGROUP IS NOT NULL OR t6.ID_WARE_GRP_OF_WARE IS NOT NULL OR t6.ID_WARE_CATEGORY IS NOT NULL)
AND (t6.ID_WARE_GROUP IS NULL OR t6.ID_WARE_GROUP = t2.ware_grp)
AND (t6.ID_WARE_SUBGROUP IS NULL OR t6.ID_WARE_SUBGROUP = t2.ware_subgrp)
AND (t6.ID_WARE_GRP_OF_WARE IS NULL OR t6.ID_WARE_GRP_OF_WARE = t2.ware_grp_of_ware)
AND (t6.ID_WARE_CATEGORY IS NULL OR t6.ID_WARE_CATEGORY = t2.ware_category)
) AS ATTR_GROUP,
'Дополнительная фотография' as ATTR_NAME, t3.id_document || '.' || COALESCE(SUBSTR(t3.file_name,DECODE(INSTR(t3.file_name,'.',-1),0,NULL,INSTR(t3.file_name,'.',-1))+1),SUBSTR(t3.file_type,3),'jpg') AS VALUE
FROM t_ware_ishopattr t1, t_wl_ware t2, t_ware_document t3, t_wl_ware_ent t4
WHERE t1.id_ware = t2.id_ware AND t2.id_ware = t4.id_ware AND t4.attr_code = 'obj_1056' AND t3.key_parent = t4.value AND t3.parent_type = 'obj_28' AND t3.is_main IS NULL AND t3.doc_type = 'PHOTO'
) t9, (select id_ware, max(dt_beg) as discount_change FROM T_ware_discount WHERE DT_BEG < SYSDATE AND DT_END >= SYSDATE group by id_ware) t10
WHERE t9.id_ware = t10.id_ware(+);

